class Solution(object):
    def findMinHeightTrees(self, n, edges):
        """
        :type n: int
        :type edges: List[List[int]]
        :rtype: List[int]
        """
        if len(edges) == 0:
            return [0]

        from collections import defaultdict
        self.edges = defaultdict(list)
        for edge in edges:
            if edge[0] not in self.edges:
                self.edges[edge[0]] = list()
            self.edges[edge[0]].append(edge[1])
            if edge[1] not in self.edges:
                self.edges[edge[1]] = list()
            self.edges[edge[1]].append(edge[0])

        self.mini = len(edges) + 1
        self.anses = []

        def doHeight(vertex):
            from collections import deque
            bfs = deque()
            bfs.append(vertex)
            visited = [vertex]
            height = 0
            while bfs:
                height += 1
                size = len(bfs)
                for x in range(size):
                    curr = bfs.popleft()
                    for node in self.edges[curr]:
                        if node not in visited:
                            bfs.append(node)
                            visited.append(node)
                if height > self.mini:
                    return self.mini + 1
            return height

        for vertex in self.edges:
            height = doHeight(vertex)
            if height < self.mini:
                self.mini = height
                self.anses = [vertex]
            elif height == self.mini:
                self.anses.append(vertex)
        return self.anses

n = 4
edges = [[1,0],[1,2],[1,3]]

n = 6
edges = [[3,0],[3,1],[3,2],[3,4],[5,4]]

#n = 1
#edges = []

n = 808
edges = [[0,1],[1,2],[0,3],[2,4],[1,5],[2,6],[3,7],[1,8],[4,9],[1,10],[3,11],[8,12],[7,13],[8,14],[0,15],[1,16],[6,17],[9,18],[17,19],[15,20],[10,21],[16,22],[0,23],[6,24],[2,25],[2,26],[0,27],[2,28],[19,29],[13,30],[18,31],[12,32],[5,33],[5,34],[1,35],[20,36],[19,37],[15,38],[6,39],[9,40],[10,41],[1,42],[35,43],[1,44],[42,45],[27,46],[11,47],[41,48],[41,49],[2,50],[28,51],[22,52],[2,53],[15,54],[26,55],[0,56],[35,57],[3,58],[17,59],[52,60],[0,61],[61,62],[56,63],[16,64],[5,65],[7,66],[6,67],[9,68],[53,69],[20,70],[11,71],[41,72],[33,73],[35,74],[27,75],[46,76],[15,77],[19,78],[26,79],[32,80],[29,81],[15,82],[55,83],[77,84],[25,85],[50,86],[19,87],[63,88],[63,89],[28,90],[16,91],[52,92],[78,93],[13,94],[74,95],[95,96],[64,97],[41,98],[6,99],[59,100],[23,101],[30,102],[50,103],[56,104],[59,105],[22,106],[67,107],[94,108],[92,109],[41,110],[58,111],[70,112],[47,113],[65,114],[94,115],[60,116],[2,117],[12,118],[96,119],[103,120],[88,121],[40,122],[34,123],[1,124],[35,125],[6,126],[22,127],[24,128],[116,129],[25,130],[56,131],[29,132],[41,133],[108,134],[74,135],[74,136],[130,137],[1,138],[37,139],[14,140],[130,141],[47,142],[101,143],[1,144],[28,145],[114,146],[16,147],[13,148],[44,149],[145,150],[124,151],[84,152],[119,153],[56,154],[84,155],[144,156],[14,157],[88,158],[155,159],[125,160],[130,161],[87,162],[74,163],[45,164],[7,165],[34,166],[31,167],[123,168],[8,169],[137,170],[39,171],[157,172],[32,173],[55,174],[90,175],[99,176],[145,177],[83,178],[1,179],[57,180],[151,181],[115,182],[159,183],[99,184],[127,185],[90,186],[136,187],[148,188],[163,189],[19,190],[162,191],[73,192],[32,193],[157,194],[68,195],[91,196],[90,197],[12,198],[124,199],[199,200],[86,201],[39,202],[153,203],[91,204],[87,205],[59,206],[3,207],[114,208],[190,209],[135,210],[76,211],[26,212],[185,213],[143,214],[138,215],[14,216],[94,217],[202,218],[199,219],[110,220],[163,221],[47,222],[144,223],[163,224],[141,225],[158,226],[58,227],[76,228],[212,229],[29,230],[15,231],[67,232],[217,233],[108,234],[218,235],[202,236],[231,237],[171,238],[99,239],[177,240],[240,241],[218,242],[214,243],[20,244],[124,245],[83,246],[142,247],[58,248],[126,249],[121,250],[151,251],[150,252],[83,253],[223,254],[69,255],[34,256],[191,257],[172,258],[78,259],[3,260],[27,261],[196,262],[192,263],[9,264],[41,265],[83,266],[37,267],[43,268],[242,269],[33,270],[219,271],[67,272],[72,273],[111,274],[77,275],[10,276],[27,277],[175,278],[192,279],[188,280],[276,281],[139,282],[118,283],[119,284],[197,285],[151,286],[45,287],[273,288],[101,289],[94,290],[247,291],[265,292],[235,293],[247,294],[11,295],[182,296],[221,297],[171,298],[149,299],[225,300],[299,301],[236,302],[134,303],[286,304],[235,305],[74,306],[290,307],[117,308],[167,309],[92,310],[139,311],[302,312],[69,313],[239,314],[51,315],[265,316],[55,317],[165,318],[219,319],[174,320],[117,321],[307,322],[288,323],[142,324],[161,325],[198,326],[235,327],[143,328],[113,329],[66,330],[236,331],[129,332],[222,333],[320,334],[36,335],[229,336],[248,337],[303,338],[330,339],[288,340],[244,341],[336,342],[105,343],[157,344],[156,345],[312,346],[40,347],[209,348],[19,349],[155,350],[50,351],[264,352],[55,353],[295,354],[301,355],[153,356],[135,357],[123,358],[235,359],[318,360],[320,361],[3,362],[28,363],[30,364],[209,365],[1,366],[210,367],[188,368],[33,369],[24,370],[367,371],[296,372],[62,373],[371,374],[130,375],[126,376],[357,377],[108,378],[269,379],[47,380],[47,381],[127,382],[327,383],[324,384],[224,385],[96,386],[361,387],[143,388],[228,389],[263,390],[17,391],[225,392],[181,393],[327,394],[46,395],[382,396],[371,397],[162,398],[355,399],[358,400],[149,401],[241,402],[58,403],[317,404],[10,405],[129,406],[10,407],[139,408],[269,409],[96,410],[338,411],[310,412],[352,413],[359,414],[301,415],[7,416],[388,417],[311,418],[387,419],[375,420],[411,421],[175,422],[162,423],[402,424],[326,425],[226,426],[232,427],[301,428],[136,429],[347,430],[38,431],[9,432],[54,433],[130,434],[178,435],[289,436],[125,437],[374,438],[312,439],[322,440],[214,441],[348,442],[91,443],[327,444],[266,445],[102,446],[371,447],[307,448],[200,449],[359,450],[176,451],[217,452],[200,453],[431,454],[117,455],[231,456],[250,457],[100,458],[196,459],[260,460],[272,461],[386,462],[15,463],[8,464],[108,465],[456,466],[465,467],[367,468],[118,469],[370,470],[152,471],[293,472],[416,473],[197,474],[431,475],[469,476],[150,477],[424,478],[233,479],[173,480],[431,481],[358,482],[377,483],[198,484],[189,485],[259,486],[461,487],[210,488],[307,489],[188,490],[422,491],[454,492],[171,493],[21,494],[198,495],[231,496],[343,497],[284,498],[448,499],[205,500],[263,501],[472,502],[43,503],[306,504],[364,505],[134,506],[36,507],[61,508],[500,509],[389,510],[348,511],[488,512],[212,513],[57,514],[216,515],[514,516],[114,517],[227,518],[227,519],[313,520],[436,521],[323,522],[515,523],[280,524],[162,525],[502,526],[178,527],[490,528],[109,529],[198,530],[288,531],[191,532],[448,533],[218,534],[129,535],[499,536],[106,537],[499,538],[287,539],[54,540],[416,541],[206,542],[83,543],[348,544],[370,545],[357,546],[380,547],[308,548],[256,549],[202,550],[308,551],[126,552],[469,553],[302,554],[308,555],[78,556],[83,557],[147,558],[140,559],[85,560],[438,561],[268,562],[301,563],[234,564],[547,565],[152,566],[565,567],[134,568],[235,569],[212,570],[372,571],[377,572],[286,573],[165,574],[259,575],[345,576],[527,577],[168,578],[534,579],[509,580],[512,581],[375,582],[21,583],[287,584],[331,585],[77,586],[131,587],[443,588],[3,589],[77,590],[34,591],[428,592],[458,593],[396,594],[238,595],[522,596],[28,597],[353,598],[497,599],[318,600],[465,601],[270,602],[256,603],[389,604],[307,605],[536,606],[92,607],[243,608],[58,609],[86,610],[308,611],[301,612],[333,613],[514,614],[459,615],[151,616],[377,617],[338,618],[246,619],[199,620],[351,621],[252,622],[285,623],[611,624],[543,625],[198,626],[407,627],[210,628],[393,629],[211,630],[111,631],[326,632],[347,633],[100,634],[206,635],[183,636],[318,637],[266,638],[243,639],[208,640],[551,641],[490,642],[458,643],[178,644],[505,645],[302,646],[11,647],[329,648],[149,649],[608,650],[153,651],[223,652],[604,653],[572,654],[604,655],[542,656],[541,657],[438,658],[104,659],[490,660],[38,661],[212,662],[161,663],[572,664],[553,665],[640,666],[31,667],[66,668],[113,669],[142,670],[19,671],[370,672],[542,673],[43,674],[532,675],[507,676],[52,677],[389,678],[449,679],[475,680],[98,681],[224,682],[85,683],[351,684],[209,685],[242,686],[646,687],[209,688],[225,689],[457,690],[325,691],[68,692],[505,693],[222,694],[197,695],[227,696],[296,697],[567,698],[473,699],[231,700],[595,701],[448,702],[261,703],[479,704],[357,705],[555,706],[358,707],[570,708],[350,709],[321,710],[174,711],[448,712],[337,713],[618,714],[415,715],[222,716],[140,717],[550,718],[629,719],[640,720],[245,721],[249,722],[336,723],[429,724],[43,725],[207,726],[419,727],[694,728],[136,729],[464,730],[130,731],[681,732],[395,733],[572,734],[425,735],[154,736],[539,737],[345,738],[386,739],[55,740],[192,741],[497,742],[674,743],[723,744],[131,745],[244,746],[42,747],[125,748],[136,749],[298,750],[152,751],[15,752],[157,753],[667,754],[511,755],[479,756],[86,757],[47,758],[580,759],[475,760],[632,761],[259,762],[400,763],[93,764],[301,765],[445,766],[405,767],[294,768],[281,769],[25,770],[199,771],[403,772],[731,773],[119,774],[87,775],[394,776],[547,777],[47,778],[717,779],[779,780],[522,781],[231,782],[212,783],[163,784],[581,785],[224,786],[536,787],[762,788],[211,789],[169,790],[215,791],[749,792],[757,793],[152,794],[505,795],[379,796],[691,797],[638,798],[376,799],[41,800],[109,801],[711,802],[649,803],[514,804],[616,805],[46,806],[538,807]]

n = 909
edges = [[0,1],[0,2],[2,3],[0,4],[4,5],[0,6],[6,7],[0,8],[7,9],[1,10],[0,11],[10,12],[8,13],[3,14],[1,15],[1,16],[4,17],[7,18],[15,19],[1,20],[14,21],[9,22],[14,23],[15,24],[7,25],[0,26],[24,27],[13,28],[22,29],[18,30],[18,31],[17,32],[14,33],[20,34],[1,35],[14,36],[14,37],[30,38],[13,39],[6,40],[32,41],[17,42],[23,43],[23,44],[6,45],[27,46],[9,47],[4,48],[16,49],[31,50],[21,51],[21,52],[31,53],[53,54],[18,55],[3,56],[7,57],[52,58],[14,59],[10,60],[20,61],[17,62],[2,63],[36,64],[25,65],[53,66],[61,67],[23,68],[14,69],[29,70],[63,71],[12,72],[6,73],[11,74],[73,75],[60,76],[38,77],[61,78],[71,79],[20,80],[24,81],[60,82],[52,83],[68,84],[22,85],[36,86],[85,87],[9,88],[15,89],[56,90],[16,91],[67,92],[24,93],[63,94],[41,95],[57,96],[83,97],[90,98],[38,99],[54,100],[97,101],[4,102],[51,103],[31,104],[22,105],[102,106],[95,107],[71,108],[9,109],[53,110],[62,111],[110,112],[5,113],[27,114],[104,115],[35,116],[14,117],[0,118],[106,119],[37,120],[8,121],[26,122],[87,123],[49,124],[74,125],[61,126],[17,127],[89,128],[58,129],[33,130],[36,131],[50,132],[43,133],[121,134],[32,135],[113,136],[64,137],[73,138],[13,139],[133,140],[89,141],[36,142],[86,143],[117,144],[11,145],[70,146],[98,147],[82,148],[28,149],[61,150],[66,151],[59,152],[51,153],[49,154],[61,155],[76,156],[155,157],[57,158],[112,159],[19,160],[60,161],[88,162],[62,163],[52,164],[126,165],[48,166],[47,167],[136,168],[15,169],[7,170],[85,171],[61,172],[110,173],[81,174],[135,175],[60,176],[95,177],[171,178],[161,179],[44,180],[19,181],[175,182],[107,183],[23,184],[66,185],[122,186],[128,187],[147,188],[139,189],[135,190],[19,191],[103,192],[51,193],[158,194],[99,195],[75,196],[4,197],[26,198],[131,199],[167,200],[83,201],[131,202],[55,203],[32,204],[164,205],[98,206],[86,207],[170,208],[170,209],[188,210],[40,211],[46,212],[31,213],[18,214],[116,215],[13,216],[212,217],[148,218],[88,219],[19,220],[81,221],[137,222],[23,223],[58,224],[163,225],[145,226],[116,227],[45,228],[31,229],[47,230],[66,231],[82,232],[59,233],[229,234],[164,235],[122,236],[31,237],[143,238],[178,239],[32,240],[97,241],[89,242],[117,243],[191,244],[76,245],[25,246],[217,247],[106,248],[37,249],[12,250],[47,251],[163,252],[247,253],[253,254],[19,255],[245,256],[67,257],[108,258],[50,259],[115,260],[67,261],[248,262],[148,263],[149,264],[220,265],[54,266],[134,267],[2,268],[161,269],[265,270],[31,271],[83,272],[162,273],[267,274],[21,275],[72,276],[26,277],[112,278],[268,279],[41,280],[84,281],[196,282],[281,283],[109,284],[118,285],[66,286],[167,287],[142,288],[154,289],[262,290],[158,291],[216,292],[26,293],[30,294],[60,295],[276,296],[72,297],[215,298],[7,299],[69,300],[289,301],[54,302],[210,303],[280,304],[204,305],[186,306],[217,307],[305,308],[225,309],[13,310],[3,311],[110,312],[82,313],[155,314],[22,315],[66,316],[223,317],[252,318],[229,319],[247,320],[231,321],[190,322],[308,323],[26,324],[245,325],[123,326],[91,327],[308,328],[17,329],[78,330],[136,331],[7,332],[146,333],[318,334],[273,335],[161,336],[35,337],[241,338],[282,339],[133,340],[136,341],[8,342],[146,343],[117,344],[15,345],[102,346],[52,347],[21,348],[166,349],[131,350],[178,351],[142,352],[7,353],[255,354],[346,355],[162,356],[16,357],[253,358],[285,359],[23,360],[7,361],[96,362],[128,363],[231,364],[223,365],[275,366],[347,367],[244,368],[203,369],[55,370],[182,371],[170,372],[270,373],[315,374],[85,375],[346,376],[212,377],[102,378],[319,379],[252,380],[264,381],[351,382],[164,383],[233,384],[361,385],[175,386],[230,387],[331,388],[57,389],[119,390],[118,391],[251,392],[306,393],[255,394],[199,395],[238,396],[17,397],[197,398],[151,399],[356,400],[395,401],[191,402],[16,403],[13,404],[110,405],[313,406],[340,407],[161,408],[301,409],[44,410],[364,411],[272,412],[100,413],[312,414],[307,415],[347,416],[374,417],[187,418],[328,419],[118,420],[311,421],[321,422],[108,423],[395,424],[190,425],[299,426],[79,427],[68,428],[240,429],[386,430],[371,431],[5,432],[255,433],[320,434],[376,435],[81,436],[68,437],[54,438],[421,439],[423,440],[311,441],[41,442],[3,443],[400,444],[137,445],[253,446],[335,447],[376,448],[1,449],[212,450],[169,451],[383,452],[401,453],[383,454],[54,455],[59,456],[35,457],[121,458],[173,459],[388,460],[456,461],[81,462],[368,463],[219,464],[178,465],[114,466],[384,467],[104,468],[268,469],[170,470],[246,471],[319,472],[258,473],[326,474],[241,475],[25,476],[468,477],[444,478],[418,479],[405,480],[261,481],[447,482],[140,483],[30,484],[375,485],[75,486],[455,487],[64,488],[236,489],[454,490],[207,491],[431,492],[290,493],[84,494],[409,495],[315,496],[343,497],[480,498],[451,499],[155,500],[262,501],[111,502],[441,503],[237,504],[387,505],[275,506],[75,507],[259,508],[465,509],[433,510],[217,511],[450,512],[30,513],[479,514],[179,515],[102,516],[181,517],[153,518],[208,519],[380,520],[256,521],[276,522],[253,523],[417,524],[179,525],[305,526],[450,527],[407,528],[442,529],[99,530],[381,531],[89,532],[507,533],[347,534],[132,535],[445,536],[197,537],[255,538],[479,539],[322,540],[277,541],[342,542],[44,543],[443,544],[322,545],[96,546],[397,547],[195,548],[316,549],[13,550],[397,551],[405,552],[250,553],[365,554],[108,555],[213,556],[97,557],[406,558],[156,559],[421,560],[80,561],[328,562],[303,563],[243,564],[269,565],[485,566],[457,567],[371,568],[201,569],[337,570],[183,571],[221,572],[113,573],[447,574],[244,575],[429,576],[126,577],[69,578],[535,579],[303,580],[283,581],[567,582],[209,583],[21,584],[227,585],[21,586],[16,587],[268,588],[45,589],[107,590],[141,591],[40,592],[157,593],[328,594],[68,595],[225,596],[219,597],[301,598],[44,599],[515,600],[334,601],[229,602],[95,603],[177,604],[408,605],[119,606],[200,607],[334,608],[142,609],[437,610],[391,611],[272,612],[231,613],[566,614],[64,615],[186,616],[584,617],[9,618],[369,619],[21,620],[477,621],[17,622],[604,623],[228,624],[225,625],[615,626],[403,627],[90,628],[459,629],[171,630],[52,631],[626,632],[385,633],[96,634],[120,635],[161,636],[86,637],[14,638],[302,639],[402,640],[191,641],[355,642],[475,643],[267,644],[616,645],[10,646],[595,647],[295,648],[332,649],[78,650],[334,651],[402,652],[215,653],[328,654],[383,655],[461,656],[608,657],[590,658],[427,659],[115,660],[301,661],[579,662],[361,663],[602,664],[215,665],[181,666],[292,667],[126,668],[160,669],[640,670],[559,671],[301,672],[221,673],[226,674],[430,675],[403,676],[484,677],[395,678],[659,679],[169,680],[627,681],[48,682],[421,683],[589,684],[100,685],[662,686],[244,687],[440,688],[623,689],[626,690],[46,691],[148,692],[688,693],[87,694],[635,695],[609,696],[186,697],[317,698],[654,699],[412,700],[291,701],[481,702],[639,703],[596,704],[40,705],[382,706],[222,707],[445,708],[409,709],[612,710],[214,711],[658,712],[363,713],[399,714],[335,715],[274,716],[21,717],[109,718],[232,719],[551,720],[113,721],[78,722],[20,723],[172,724],[192,725],[291,726],[47,727],[378,728],[372,729],[349,730],[696,731],[362,732],[509,733],[603,734],[481,735],[633,736],[709,737],[610,738],[671,739],[525,740],[176,741],[329,742],[451,743],[23,744],[190,745],[473,746],[234,747],[470,748],[160,749],[599,750],[50,751],[176,752],[69,753],[525,754],[97,755],[692,756],[117,757],[364,758],[627,759],[393,760],[415,761],[222,762],[737,763],[461,764],[392,765],[28,766],[663,767],[274,768],[673,769],[607,770],[160,771],[222,772],[605,773],[342,774],[418,775],[269,776],[371,777],[235,778],[299,779],[725,780],[297,781],[233,782],[260,783],[214,784],[247,785],[170,786],[517,787],[612,788],[246,789],[52,790],[173,791],[490,792],[297,793],[451,794],[309,795],[65,796],[352,797],[178,798],[403,799],[338,800],[342,801],[282,802],[317,803],[361,804],[479,805],[141,806],[280,807],[303,808],[265,809],[172,810],[42,811],[39,812],[133,813],[339,814],[744,815],[765,816],[165,817],[323,818],[238,819],[95,820],[76,821],[37,822],[283,823],[410,824],[464,825],[666,826],[23,827],[669,828],[77,829],[512,830],[739,831],[813,832],[342,833],[18,834],[354,835],[641,836],[318,837],[480,838],[287,839],[521,840],[29,841],[224,842],[9,843],[119,844],[47,845],[291,846],[239,847],[249,848],[448,849],[347,850],[380,851],[354,852],[473,853],[55,854],[413,855],[635,856],[350,857],[454,858],[80,859],[550,860],[361,861],[660,862],[427,863],[535,864],[317,865],[162,866],[427,867],[732,868],[4,869],[611,870],[771,871],[311,872],[600,873],[809,874],[634,875],[618,876],[123,877],[373,878],[600,879],[686,880],[610,881],[361,882],[108,883],[397,884],[766,885],[440,886],[434,887],[627,888],[263,889],[316,890],[651,891],[668,892],[119,893],[696,894],[624,895],[133,896],[228,897],[71,898],[162,899],[496,900],[749,901],[802,902],[471,903],[117,904],[84,905],[212,906],[42,907],[351,908]]

solution = Solution()
print(solution.findMinHeightTrees(n, edges))
