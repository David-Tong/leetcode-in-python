class Solution(object):
    def minRefuelStops(self, target, startFuel, stations):
        """
        :type target: int
        :type startFuel: int
        :type stations: List[List[int]]
        :rtype: int
        """
        L = len(stations)

        # dp[y] - the furthest distance can be reached after y refuels
        dp = [startFuel] + [0] * L
        for x, (position, fuel) in enumerate(stations):
            for y in range(x, -1, -1):
                if dp[y] >= position:
                    dp[y + 1] = max(dp[y + 1], dp[y] + fuel)

        for y in range(L + 1):
            if dp[y] >= target:
                return y
        return -1


target = 1
startFuel = 1
stations = []

target = 100
startFuel = 1
stations = [[10,100]]

target = 100
startFuel = 10
stations = [[10,60],[20,30],[30,30],[60,40]]

target = 1000000
startFuel = 53667
stations = [[6680,28239],[15506,128291],[19192,169228],[23503,206474],[45408,93680],[62752,99363],[62921,51594],[86810,75904],[92456,283001],[100635,238176],[105276,146425],[107150,323901],[108871,297826],[110723,77281],[114121,123647],[115816,121206],[116429,313300],[134429,303359],[156970,158829],[175685,163827],[191438,125082],[220718,288036],[224934,115497],[229087,21603],[247267,136178],[251598,56387],[262725,9730],[279437,327764],[286706,8499],[293605,282724],[297457,13889],[317177,223117],[320346,260554],[321743,64988],[326755,260258],[367182,247997],[374717,163135],[375035,304807],[393977,196991],[404580,212038],[413405,24239],[444929,52245],[473587,115070],[476722,136669],[487058,51889],[489535,38590],[489598,1556],[491323,162582],[510296,278725],[516178,278067],[531142,253554],[532535,5109],[535918,327309],[536120,142224],[538382,191799],[593463,61984],[599006,80125],[609832,72452],[610863,10226],[615960,43639],[638074,217729],[643889,196494],[653418,99395],[662613,146526],[668161,66198],[673502,32349],[674526,75927],[695915,199779],[700467,121710],[709938,308714],[717658,155333],[718431,327490],[724699,118320],[730982,249460],[731025,63622],[741216,9356],[760482,92573],[774191,187382],[792690,314162],[800827,95568],[805302,192594],[812215,117599],[840924,333296],[844378,192341],[849477,40739],[877711,74824],[883717,46024],[892780,253545],[912315,318315],[914816,235664],[915096,202169],[926478,216664],[929404,78695],[937518,296279],[938332,279273],[948469,247314],[966588,317887],[972588,163087],[983770,295889],[988521,219505]]

target = 1000
startFuel = 83
stations = [[47,220],[65,1],[98,113],[126,196],[186,218],[320,205],[686,317],[707,325],[754,104],[781,105]]

target = 999
startFuel = 1000
stations = [[5,100],[997,100],[998,100]]

solution = Solution()
print(solution.minRefuelStops(target, startFuel, stations))
