class Solution(object):
    def furthestBuilding(self, heights, bricks, ladders):
        """
        :type heights: List[int]
        :type bricks: int
        :type ladders: int
        :rtype: int
        """
        def canReach(index, ups, bricks, ladders):
            to_climbs = sorted(ups[:index + 1])
            to_climbs = to_climbs[:max(0, index + 1 - ladders)]
            if bricks >= sum(to_climbs):
                return True
            else:
                return False

        L = len(heights)
        ups = [0] * L
        for idx in range(1, L):
            ups[idx] = max(0, heights[idx] - heights[idx - 1])

        left = 0
        right = L - 1

        while left + 1 < right:
            middle = (left + right) // 2
            if canReach(middle, ups, bricks, ladders):
                left = middle + 1
            else:
                right = middle - 1

        if canReach(right, ups, bricks, ladders):
            return right
        elif canReach(left, ups, bricks, ladders):
            return left
        else:
            return left - 1


heights = [4,2,7,6,9,14,12]
bricks = 5
ladders = 1

heights = [4,12,2,7,3,18,20,3,19]
bricks = 10
ladders = 2

heights = [14,3,19,3]
bricks = 17
ladders = 0

heights = [1]
bricks = 0
ladders = 0

heights = [7,5,13]
bricks = 0
ladders = 0

heights = [67207,762922,549456,219211,647320,184006,285574,433916,179295,995807,883463,325959,58174,564383,807565,882617,941705,306354,525355,550954,379735,429804,303619,423511,281570,182469,394384,90942,725242,986862,284545,932695,404501,965917,378982,705870,838499,177942,750466,966582,45127,443166,173946,282759,653016,670729,506320,210145,350677,734620,946098,606372,644779,662684,695592,899707,448731,455890,510529,159667,317289,55054,797642,700509,906557,844358,901275,66064,95734,23707,48352,358511,772008,420514,278567,439239,324930,241613,481775,23426,833127,588801,747447,395752,120224,446599,655285,920528,416955,49132,330579,152369,417123,457843,997533,134586,328123,794086,784962,519128,703374,161566,789040,8459,919126,666417,314699,657557,915636,534136,727965,287350,10978,507352,704420,247656,311204,928940,771178,282632,699784,200109,428741,563866,707810,232096,602574,571452,235225,429256,8384,254457,632684,835990,771047,764520,345554,951762,993592,91926,291041,284550,2872,96415,897482,697349,633035,184590,625462,348075,772132,464551,641841,667510,585170,183813,84395,193711,401705,847263,217606,665561,727542,642448,104033,856000,757838,918072,728350,59931,80221,162003,560560,769247,377776,917690,9700,438615,765752,387428,838216,965572,353260,651209,920425,349811,203966,458157,464361,123150,274722,982600,836528,937044,294180,378864,403868,256555,157317,798022,549884,907055,456749,874175,162658,593848,162826,817281,587718,69327,192438,552784,867134,757441,697854,17945,380141,140296,632665,343724,518246,373354,771206,862074,418803,204533,45652,27308,212231,774466,779453,906478,28453,524090,600861,14626,866353,891615,507237,668233,875675,229029,364549,817395,504979,886248,16204,611843,897072,63006,17584,318443,105766,928639,770549,638481,211782,576325,678434,122809,120981,398605,309385,32671,969215,418478,788046,162383,365596,852864,207510,61356,142831,888059,87757,95757,229804,793180,306190,259266,47310,178435,81241,725404,323639,786826,378543,912927,835046,435032,330629,540980,823466,800580,963462,112163,704082,651854,648656,350448,206770,224566,975955,278326,520464,244440,286025,704936,675826,709071,39630,662303,852102,387949,101784,231627,690318,219292,98533,676295,512279,542401,567055,430642,888733,923734,754851,847599,680690,568964,720616,666400,947432,301202,990192,2601,38910,84723,579161,511693,613326,212920,351854,881490,115418,380527,160727,731364,74253,236815,767849,663018,712434,996120,365527,713501,21202,596631,859694,980393,782628,434409,390094,871247,248698,122042,897827,774725,859616,128573,528226,668530,276243,871365,92721,736667,732020,376026,411548,981822,449087,314762,929927,517826,750166,145664,267062,971331,265809,314347,655393,959171,106895,636394,855834,754498,586393,776064,747262,865888,197447,682128,679607,136129,23508,536503,819866,184344,190958,118171,890803,159710,215999,58146,486749,209349,573523,606185,931279,77773,681536,49033,674314,515522,133414,294492,472058,914666,455257,456316,196558,24418,904186,995316,263829,873223,608904,259083,766022,989907,30850,802228,534222,110131,790213,224107,841389,592373,115999,360335,826214,998787,112078,834722,691021,855432,802692,970715,477287,330714,515769,466685,957057,234774,100261,963800,315919,203735,150514,840820,66487,224890,253666,6296,751396,373593,297945,971847,953446,913539,318656,408091,465898,606129,300347,976618,815792,954661,327098,787037,127832,521931,513992,988721,465660,328822,588,618005,817286,510713,138834,430281,654634,812257,15673,173383,321526,410315,44839,423336,474392,530684,765103,735082,306346,905792,410627,113316,440895,158481,79621,284124,14135,144776,458055,424511,3093,835830,253470,302757,383950,802947,970186,1436,239623,597583,628661,502307,425433,980848,221003,609884,545078,130103,49968,397758,186944,139600,426963,901969,523039,909965,666281,148329,739966,677895,190430,896061,914384,485970,653801,699404,950889,937338,909305,15444,936459,156676,418420,588602,549830,830128,174669,617974,254588,686950,862959,149368,295558,79669,445827,635702,892256,373576,572150,602389,548959,178613,837523,560120,848362,764231,509082,997194,488573,643,579899,2608,717883,653222,967598,435780,19242,227288,982933,264268,913933,829947,359891,349474,637270,777476,115860,408900,861653,335384,167310,572037,58932,633836,912029,448234,894519,343203,964408,998648,593398,579472,346986,443182,778418,70494,888001,832831,975219,212370,865348,946524,885317,419617,570790,587786,71424,61840,97600,936655,403946,541153,116138,890803,462994,914516,643598,646177,146862,466818,201631,493262,226677,230292,383346,217027,162423,885002,751036,718298,124732,999404,384426,255314,324699,313918,600808,600848,580423,911978,352513,166443,999932,286645,911956,46417,740226,896624,839583,341881,59297,674027,676445,980011,586142,579573,476487,397489,745047,287447,100677,291998,272848,283393,990779,759740,270930,234792,319231,66138,420940,678335,231805,87318,335496,494296,445015,458812,810050,258562,680968,495124,363104,107336,51553,607758,498898,326137,536716,460644,249198,927146,964753,584825,522281,384100,748206,378400,622547,618781,443380,498596,481542,55502,877457,273999,834873,497914,766499,857909,81550,985310,217898,567256,32649,486510,642793,417242,545181,18014,195607,237629,820504,251225,536886,851550,49022,880851,482464,399093,681320,638281,103089,518751,49995,343045,482769,245336,801058,604467,802431,888554,582974,40612,844184,591536,549966,156078,878728,597452,245350,388883,477926,127377,501825,573329,335045,16636,981949,474275,141806,918491,692866,268737,288085,801035,441333,566055,658561,567092,446111,305692,453159,669962,430358,401828,571608,735095,215916,791710,929974,648535,868671,907258,184960,823212,762305,496296,995367,638027,957381,128497,496164,370472,749833,687203,650607,916277,440016,22242,265871,810113,584855,559488,343971,323821,663440,256825,917013,641062,186119,28101,949298,85716,945679,826602,546128,872060,942983,667263,678386,854008,336664,887616,367986,183331,734345,261720,805450,767002,876018,671489,72105,608901,94514,849203,569149,436455,690328,223139,163804,959096,545770,98712,83490,886993,739926,584000,699434,434593,210604,834458,305494,548717,737246,639758,631563,437382,94633,641051,340579,134406,738869,671512,409849,434641,502825,221275,547117,561845,129597,843768,945185,516832,434662,689298,772545,33603,907068,283752,818315,797151,685356,197368,173007,349916,848041,28496,32413,814885,647754,824906,579336,720536,659202,734585,871265,167800,897715,85781]
bricks = 7811630
ladders = 728

solution = Solution()
print(solution.furthestBuilding(heights, bricks, ladders))